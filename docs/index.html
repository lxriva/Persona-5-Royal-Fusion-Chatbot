<!DOCTYPE html>
<html lang="en">

<script>window.BACKEND_URL = "https://avi-ai-1-p5r-fusion-chatbot.onrender.com";</script>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>P5R Fusion Chatbot</title>
    <!-- Canonical -->
<link rel="canonical" href="https://lxriva.github.io/Avi-AI-1-P5R-Fusion-Chatbot/">

<!-- Basic SEO -->
<meta name="description" content="AI-powered Persona 5 Royal fusion calculator chatbot. Ask for fusion recipes, components, skills, and special fusions like Satanael or Yoshitsune.">
<meta name="keywords" content="P5R fusion calculator, Persona 5 Royal, Persona fusion, fusion recipes, Megaten, SMT, Persona chatbot">

<!-- Open Graph (social + helps Google understand the page) -->
<meta property="og:type" content="website">
<meta property="og:title" content="P5R Fusion Chatbot – Persona 5 Royal Fusion Calculator">
<meta property="og:description" content="Chat with an AI fusion calculator for Persona 5 Royal. Get normal and special fusion recipes, components, and skill info.">
<meta property="og:url" content="https://lxriva.github.io/Avi-AI-1-P5R-Fusion-Chatbot/">
<meta property="og:image" content="https://lxriva.github.io/Avi-AI-1-P5R-Fusion-Chatbot/og-image.png">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="P5R Fusion Chatbot – Persona 5 Royal Fusion Calculator">
<meta name="twitter:description" content="Ask about Yoshitsune, Trumpeter, Alice, Satanael and more.">
<meta name="twitter:image" content="https://lxriva.github.io/Avi-AI-1-P5R-Fusion-Chatbot/og-image.png">

<!-- Structured Data: mark it as a web app/tool -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "P5R Fusion Chatbot",
  "applicationCategory": "EducationalApplication",
  "operatingSystem": "Web",
  "url": "https://lxriva.github.io/Avi-AI-1-P5R-Fusion-Chatbot/",
  "description": "AI-powered Persona 5 Royal fusion calculator chatbot. Ask natural-language questions about fusion recipes, components, and skills.",
  "image": "https://lxriva.github.io/Avi-AI-1-P5R-Fusion-Chatbot/og-image.png",
  "browserRequirements": "Requires JavaScript",
  "creator": {
    "@type": "Person",
    "name": "Avi"
  }
}
</script>

<!-- Optional: FAQ rich results (tiny boost) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How do I use the P5R Fusion Chatbot?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Type a question like 'How do I fuse Yoshitsune?' or 'Show normal pairs that produce Trumpeter'. The bot returns fusion recipes and components."
      }
    },
    {
      "@type": "Question",
      "name": "Does it cover special fusions like Satanael or Alice?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. Ask directly—e.g., 'What is Alice’s special fusion recipe?'—to get the exact components and notes."
      }
    }
  ]
}
</script>

    <link rel="stylesheet" href="style.css">
    <!-- Tiny inline favicon to avoid 404 -->
    <link rel="icon"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' fill='%23b30000'/%3E%3Ctext x='50%25' y='52%25' dominant-baseline='middle' text-anchor='middle' font-size='44' fill='white'%3EP%3C/text%3E%3C/svg%3E">
</head>

<body>
    <div class="header">
        <img
            class="title-banner"
            src="Persona 5 Royal Fusion Help Chatbot.png"
            alt="Persona 5 Royal — Fusion Help Chatbot"
            width="1545" height="134"
            loading="eager"
            decoding="async"
        />
        <p>Ask about normal & special recipes, components, skills, and more.</p>
    </div>

    <div class="chat-container">
        <div id="chat">
            <!-- Initial bot message -->
            <div class="message bot">
                <div class="message-avatar">🔹</div>
                <div class="message-content">
                    <strong>Velvet Attendant:</strong>
                    Welcome to the Velvet Room. Try questions like:
                    <br>- How do I fuse <em>Yoshitsune</em>?
                    <br>- Show normal pairs that produce <em>Trumpeter</em>.
                    <br>- What’s <em>Alice</em>’s special fusion recipe?
                </div>
            </div>
        </div>

        <div class="input-container">
            <input type="text" id="userInput" placeholder="Ask a P5R fusion question… e.g. “How do I fuse Satanael?”"
                autocomplete="off">
            <button class="send-button" id="sendBtn">
                <span>Send</span>
            </button>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="message-avatar">🔹</div>
        <span>Consulting the Velvet Room</span>
        <div class="loading-dots">
            <span></span><span></span><span></span>
        </div>
    </div>

    <script>
        // === Config ===
       const API_URL = (window.BACKEND_URL || "https://avi-ai-1-P5R-Fusion-Chatbot.onrender.com").replace(/\/$/, "") + "/ask";

        const input = document.getElementById("userInput");
        const chat = document.getElementById("chat");
        const loading = document.getElementById("loading");
        const sendBtn = document.getElementById("sendBtn");

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function appendMessage(role, text) {
          const wrap = document.createElement('div');
          wrap.className = `message ${role}`;
          const avatar = role === 'user' ? '🎴' : '🔹';
          const name = role === 'user' ? 'You' : 'Velvet Attendant';
        
          // Split bot responses into segments if they contain "---"
          let contentHtml;
          if (role === 'bot') {
            // Split by newline, filter blanks
            const parts = text.split(/\n+/).filter(p => p.trim() !== "");
            contentHtml = `<strong>${name}:</strong>`;
            parts.forEach((part, i) => {
              // Add divider between blocks, but not before the first
              if (i > 0) contentHtml += `<hr class="resp-divider">`;
              contentHtml += `<div class="resp-block">${escapeHtml(part)}</div>`;
            });
          } else {
            // User messages stay single block
            contentHtml = `<strong>${name}:</strong> ${escapeHtml(text)}`;
          }
        
          wrap.innerHTML = `
            <div class="message-avatar">${avatar}</div>
            <div class="message-content">${contentHtml}</div>`;
          chat.appendChild(wrap);
          chat.scrollTop = chat.scrollHeight;
        }

        async function sendMessage() {
            const question = input.value.trim();
            if (!question) return;

            appendMessage('user', question);
            input.value = '';
            input.blur();
            loading.style.display = 'flex';

            try {
                const res = await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ question })
                });

                loading.style.display = 'none';

                if (!res.ok) throw new Error(`Server error: ${res.status}`);

                const data = await res.json();
                const text = data.answer || `Error: ${data.error || 'Unknown error'}`;
                appendMessage(data.answer ? 'bot' : 'bot error', text);

            } catch (err) {
                loading.style.display = 'none';
                appendMessage('bot error', `Connection error: ${err.message}`);
            }
        }

        input.addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
                e.preventDefault();
                sendMessage();
            }
        });
        sendBtn.addEventListener("click", sendMessage);

        window.addEventListener('load', () => input.focus());
    </script>
</body>
</html>







